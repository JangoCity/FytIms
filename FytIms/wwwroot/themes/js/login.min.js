function getOffset(n,t){for(var r=t=="top"?"offsetTop":"offsetLeft",u=n[r],i=n.offsetParent;i;)u+=i[r],i=i.offsetParent;return i=null,parseInt(u)}function moveCode(n){function l(n){n.preventDefault();n=r["0"]=="touchstart"?n.touches[0]:n||window.event;t=n.clientX-c;t=t>0?t>f?f:t:0;document.getElementById("box-tip").style.display=t>30?"none":"block";t>f*.7?(i.innerText="松开验证",i.style.backgroundColor="#66CC66"):(i.innerText="",i.style.backgroundColor="#FFFF99");i.style.width=t+s+"px";e.style.left=t+"px"}function a(){document.removeEventListener(r["2"],a,!1);document.removeEventListener(r["1"],l,!1);t>f*.7?(i.innerText="验证成功",i.style.width=f+s+"px",e.style.left=f+"px",h.value=u.codeVluae,e.onmousedown=null):(i.style.width="0px",e.style.left="0px")}var u={codeVluae:n},o=document.querySelector("#code-box"),i=o.querySelector("p"),h=o.querySelector(".code-input"),e=o.querySelector("span"),r=["mousedown","mousemove","mouseup"],c,v,s,f,t;return typeof document.ontouchstart=="object"&&(r=["touchstart","touchmove","touchend"]),e.addEventListener(r["0"],function(n){n=r["0"]=="touchstart"?n.touches[0]:n||window.event;c=n.clientX;v=getOffset(o,"left");s=this.clientWidth;f=o.clientWidth-s;t;document.addEventListener(r["1"],l,!1);document.addEventListener(r["2"],a,!1)},!1),u.setCode=function(n){n&&(u.codeVluae=n)},u.getCode=function(){return u.codeVluae},u.resetCode=function(){e.removeAttribute("style");i.removeAttribute("style");h.value=""},u}layui.use(["form","layedit"],function(){var n=layui.form,t=layui.layer;n.on("submit(loginsub)",function(){var i,r,n,t;return(toastr.clear(),toastr.options={positionClass:"toast-top-center"},i=$("#hcode").val(),r=$("#code").val(),i!=r)?(toastr.warning("需要滑动完成验证~"),!1):(n=$("#loginname").val(),t=$("#loginpwd").val(),!n)?(toastr.error("请输入账号~"),!1):t?n!="admins"?(toastr.error("账号输入错误~"),!1):t!="123"?(toastr.error("密码输入错误~"),!1):(window.location.href="/oa/index/",!1):(toastr.error("请输入密码~"),!1)})});window.addEventListener("load",function(){var n=document.getElementById("hcode").value,t=new moveCode(n)});